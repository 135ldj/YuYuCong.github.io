---
layout: post
title: "机器人嵌入式运动控制器"
description: "PID,速度插补，路径插补"
categories: [study]
tags: [stm32]
redirect_from:
  - /2018/06/25/
---

> PID，速度插补，路径插补方案

* Kramdown table of contents
{:toc .toc}
# 机器人嵌入式运动控制器

Created 2018.06.26 by William Yu; Last modified: 2018.07.12-V1.0.5

Contact: [windmillyucong@163.com](mailto:windmillyucong@163.com)

Copyright ©2018 Wuhan Mushen Technology Co. , Ltd.  All rights reserved.  

武汉木神机器人责任有限公司-版权所有.

------

## 0.轮式机器人运动控制基本问题

- 1.路径跟随 PF问题


- 2.轨迹跟踪 TT问题：轨迹跟踪与路径跟随的根本区别在于描述路径或轨迹的方程是不是时间的函数，轨迹跟踪的路径是时间的函数，所以路径跟随问题可以看作是轨迹跟踪问题的一种特例。包括运动学模型的轨迹跟踪和动力学模型的轨迹跟踪


- 3.点镇定 PS问题：非连续定长控制+时变控制+混合镇定控制

------

## 1.机器人模型构建

运动学模型+动力学模型

## 2.速度控制（微观）

### 2.1 PID控制器

##### 1.自适应模糊PID调节

​	采用模糊控制区与直接控制区**组合决策**方法，在电机控制中针对传统PID算法进行改进，设计改进的模糊PID控制器。当被控量在误差允许范围内，采用模糊控制，超出误差范围采用直接控制算法。

![5](https://github.com/YuYuCong/YuYuCong.github.io/blob/master/img/5.JPG?raw=true)

##### 2.分段式积分分离PID

​	设置多组PID参数构建分段式PID控制器，有效压制超调量。

![4](https://github.com/YuYuCong/YuYuCong.github.io/blob/master/img/4.JPG?raw=true)

### 2.2 改进的S曲线加减速控制

​	对于阶跃速度指令，采用基于机器人动力学模型**改进的S曲线加减速控制**。对于速度指令插补为平滑的加减速控制，使电机平稳启动与停止，确保机器人的无冲击运行。

​	加速度脉冲问题的解决方案是，寻求高阶连续平滑的归一化时间算子以满足光滑速度曲线。目前典型的速度规划算法包括T形速度规划、三角函数（sin、cos）型曲线速度规划、指数型速度规划和S形速度规划。各算法对比：

| 速度规划算法 | 速度曲线   | 加速度曲线 | 加加速度曲线 | 实现   |
| ------ | ------ | ----- | ------ | ---- |
| T型曲线   | 不平滑    | 不连续   | ---    | 简单   |
| 三角函数曲线 | 较平滑有突变 | 不平滑   | 不连续    | 较简单  |
| 指数曲线   | 较平滑有突变 | 不连续   | ---    | 较复杂  |
| S型曲线   | 平滑有小突变 | 连续不平滑 | 不连续    | 复杂   |

​	**S曲线规划算法**是以上速度规划算法中平滑性最好的，它将电机的加减速过程分为以下7部分：1.加加速部分、2.匀加速部分、3.减加速部分、4.匀速部分、5减减速部分、6.匀减速部分、7.加减速部分。然后利用S曲线公式和当前速度指令进行速度插补。

![1](https://github.com/YuYuCong/YuYuCong.github.io/blob/master/img/1.bmp?raw=true)

​	然而传统7段S曲线速度规划J的不连续性，依旧无法获得完全平滑的速度曲线。所以我们有必要采用改进的S型速度控制算法。

​	**改进的S型速度控制算法** 将加加速度曲线该改良为半周期的正弦函数曲线，构造出连续的插补曲线。

![2](https://github.com/YuYuCong/YuYuCong.github.io/blob/master/img/2.JPG?raw=true)

### 2.3 基于临界速度分析的自适应速度规划

​	考虑机器人不同运动参数的情况下，单一速度控制模型无法适用于所有给定参数要求，所以，根据具体边界条件来分析不同参数下速度曲线的适应情况，在改进S型曲线的基础上，附加基于临界速度分析的自适应速度规划算法。

​	简单描述为——设参数锚点使得我的S曲线可调为所有的7种速度曲线模式，以应对所有情况。

​	算法实现：

```c++
Input Vs //运动初始速度
Input Ve //运动终止速度
Set jm //加加速度最大值,由机械性能决定
START
    if get v
    f(reload S)
    endif
    else
    output v
END

f(reload S)
START
solve t1,t2,t3,t4 with v_s-v_e
solve j(t) with t,jm
j(t)不定积分得a曲线
a不定积分得v曲线,
Ouput v
END

```

> 参考文献1:  48-67

#### 待研究问题：

上述算法考虑的情况均为预想加速度初始值为0，即机器人初始状态已达到速度为V的稳态。现在考虑这样一种情况，在上述更新过程中遭遇速度更新指令，所以规划初始状态的加速度值不为零的状态下，怎样设置平滑过渡曲线？



## 3.轨迹控制（宏观）

### 3.1 组合导航技术

采用**卡尔曼滤波**融合高精度惯性测量单元以及编码器数据，弥补单一捷联惯性导航的数据漂移，实现机器的高精度姿态定位。

### 3.2 连续时变轨迹跟踪控制器算法

建立仓储物流机器人运动学模型和动力学模型，设计机器人控制器算法。

以动力学模型为基础进行反馈控制器的分析，基于**Backstepping方法**设计轨迹跟踪控制器，并进一步设计连续时变轨迹跟踪控制器，使闭环系统的全局一致渐近稳定。

分析动力学模型，基于**滑模控制**思想，设计了动力学模型的**鲁棒控制**轨迹跟踪控制器，通过控制器增益参数的自适应更新，抑制不确定参数以及外部扰动对系统的影响，提高自抗扰性能，确保闭环机器人稳定性。

### 3.3 空间直线圆弧路径规划算法

#### 3.3.1 姿态规划算法

##### 基于单位四元数的姿态插补

三次样条插值

1.边界条件

#### 3.3.2 两段路径间的过度轨迹规划

##### 五次Bezier曲线过渡

![3](https://github.com/YuYuCong/YuYuCong.github.io/blob/master/img/3.JPG?raw=true)

##### 基于误差约束的过渡速度控制

​	上述过渡算法中，过渡段虽然可以保证速度、加速度和加加速度的连续，但也会引入轨迹误差，因此需要设定误差阈值，当轨迹误差在阈值范围之外时，需要在衔接点对机器人减速。

------



## 参考文献

[1]刘鹏. 基于嵌入式运动控制器的弧焊机器人控制系统研究[D].哈尔滨工业大学,2017.

[2]徐航宇. 仓储搬运机器人控制系统设计与实现[D].南京理工大学,2017.

[3]张传斌. 基于CAN总线的移动机器人分布式控制系统研究[D].山东大学,2013.

[4]薛杰辉. 基于惯性导航的移动机器人控制系统设计[D].浙江工业大学,2016.

[5]孙爽.基于模糊PID系统的自动控制器设计分析[J].机电信息,2012(06):145+147.

[6]周俊,姬长英.视觉导航轮式移动机器人横向预测模糊控制[J].农业机械学报,2002(06):76-79.

[7]贺翔,陈奕梅,郭建川,修春波.四旋翼无人飞行器双闭环PID控制器设计[J].制造业自动化,2015,37(18):23-26+36.



## Contributing / Contact

Have anything in mind that you think is awesome and would fit in this list? Feel free to send a pull request.

Feel free to [contact me](mailto:windmillyucong@163.com) anytime for anything.

-----



## License

[![CC0](http://i.creativecommons.org/p/zero/1.0/88x31.png)](http://creativecommons.org/publicdomain/zero/1.0/)

